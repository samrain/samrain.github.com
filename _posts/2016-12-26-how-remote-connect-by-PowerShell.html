<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>2016-12-26-how-remote-connect-by-PowerShell.html</title>

</head>

<body>

<hr />
<p>layout : post
category : study
tags : [PowerShell, 远程连接]
title : PowerShell如何远程连接</p>
<hr />
<ol>
<li>
<p>在服务器上用管理员权限打开PowerShell终端</p>
</li>
<li>
<p>在PowerShell终端上执行 `Enable-PSRemoting，之后的确认操作，全部选是</p>
</li>
<li>
<p>在客户端上执行以下命令，将某个IP段的的主机都加入信任列表。此处用192.168.3.*为例：</p>
</li>
</ol>
<p>`Set-Item wsman:\localhost\Client\TrustedHosts -value 192.168.3.*</p>
<ol>
<li>Enter-PSSession IP地址 -Credential 域名\用户名</li>
</ol>
<p>例如：Enter-PSSession 192.168.3.1 -Credential abc\administrator</p>
<p>注意：网上好多教程 都是说这样就可以了，但是实际会提示一个错误：</p>
<p>Enter-PSSession : 连接到远程服务器失败，错误消息如下: WinRM 客户端无法处理该请求。如果身份验证方案与 Kerberos 不同，或 
者客户端计算机未加入到域中， 则必须使用 HTTPS 传输或者必须将目标计算机添加到 TrustedHosts 配置设置。 使用 winrm.cmd 配 
置 TrustedHosts。请注意，TrustedHosts 列表中的计算机可能未经过身份验证。 通过运行以下命令可获得有关此内容的更多信息: wi 
nrm help config。 有关详细信息，请参阅 about_Remote_Troubleshooting 帮助主题。 
所在位置 行:1 字符: 16 
+ Enter-PSSession &lt;&lt;&lt;&lt;? 192.168.3.1 -Credential abc\administrator 
      + CategoryInfo            : InvalidArgument: (192.168.3.1:String) [Enter-PSSession], PSRemotingTransportException 
      + FullyQualifiedErrorId : CreateRemoteRunspaceFailed</p>
<p>网上一般都是说要添加一个TrustedHosts表，相当于一个信任列表。</p>
<p>注意这个命令需要在 客户端上执行 不是在服务端执行 且客户端需要已管理员权限执行，这一点许多教程没有说，走了不少弯路。</p>
<p>之后再用 Enter-PSSession 192.168.3.1 -Credential abc\administrator 命令就可以完成连接了。</p>
<p>有问题可以留言 尽量解答。</p>
</body>
</html>
